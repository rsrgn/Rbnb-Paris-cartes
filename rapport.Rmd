---
title: "Etude de l'offre de logements Airbnb à Paris "
author: "William NGAUV, Kadir KARAKUS, Raphaël SEROUGNE"
date: "08/02/2018"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(leaflet)
setwd("~/MEDAS/ApprochesSpatiales/Rbnb-Paris-cartes")
load('data')
```

##Abstract
<div style="text-align: justify">Nous avons analysé l'offre de logement Airbnb à Paris en croisant différentes sources de données open-source afin de montrer l'impact des loueurs "professionnels et saisonniers" sur la démographie de Paris. Malgré les contraintes réglementaires imposées par la ville de Paris, la marge réalisée de la location saisonnière par rapport à la location de longue durée peut être assez conséquente, notamment autours des zones touristiques tels que le 1er arrondissement ou le 6ème arrondissement et cela a poussé certains loueurs à enfeindre la loi.</div>


##Outils 
<div style="text-align: justify">Les pré-traitements des données a été réalisé sur Python pour les tâches d'aggrégation ou de nettoyage des données et sur R pour les traitements spaciaux. 
Les cartes ont été entièrement réalisé sous R à l'aide de la librairie "leaflet". Nous avons choisi d'utiliser cette librairie car elle nous a permis de réaliser des cartes interactives fonctionnelles et esthétiques.
Les codes sources sont disponible sur ce [dépôt Github](https://github.com/rsrgn/Rbnb-Paris-cartes)</div>


##Données
<div style="text-align: justify">Les données proviennent des sources indiqués sur l'énoncé du projet. Les liens téléchargeables sont disponibles sur les codes sources de pré-traitements de données.</div>


<br/>
<br/>

##Analyse des données
####Répartition spatiale de l'offre Airbnb et de l'hotellerie
<div style="text-align: justify">placeholder</div>


####Prix moyen d'une nuit/personne
<div style="text-align: justify">Pour traiter cette question, nous avons réalisé une jointure spatiale entre les données *Airbnb* et nos cartes de délimitations administratives afin d'obtenir le nombre d'offre par quartier/arrondissement puis nous avons réalisé une aggrégation spatiale afin d'obtenir la moyenne des prix d'une nuit par personne.</div><br/>
```{r, echo=FALSE}
pal <- colorNumeric(palette = c('#e7e1ef','#c994c7','#dd1c77'), domain = quartiers_paris$prix_moyen)
labs <- sprintf(
  "<strong>%s</strong><br/>Prix moyen : %g €",
  quartiers_paris$l_qu, quartiers_paris$prix_moyen
) %>% lapply(htmltools::HTML)

m_bnb_prix_moyen_quartiers <- leaflet(quartiers_paris) %>%
  addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
  addPolygons(color="white",
              dashArray = "3",
              weight=2,
              smoothFactor = 0.3,
              fillOpacity = 0.9,
              fillColor = ~pal(prix_moyen),
              label = labs,
              labelOptions = labelOptions(
                style = list("font-weight" = "normal", padding = "3px 8px"),
                textsize = "15px",
                direction = "auto")) %>%
  addLegend(pal = pal,
            values = ~prix_moyen,
            opacity = 1.0,
            title = "Prix moyen nuit/personne")

pal1 <- colorNumeric(palette = c('#e7e1ef','#c994c7','#dd1c77'), domain = arrondissements_paris_sf$prix_moyen)
labs1 <- sprintf(
  "<strong>%s</strong><br/>Prix moyen : %g €",
  arrondissements_paris_sf$l_ar, arrondissements_paris_sf$prix_moyen
) %>% lapply(htmltools::HTML)
m_bnb_prix_moyen_arrdt <- leaflet(arrondissements_paris_sf) %>%
  addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
  addPolygons(color="white",
              dashArray = "3",
              weight=2,
              smoothFactor = 0.3,
              fillOpacity = 0.9,
              fillColor = ~pal(prix_moyen),
              label = labs1,
              labelOptions = labelOptions(
                style = list("font-weight" = "normal", padding = "3px 8px"),
                textsize = "15px",
                direction = "auto")) %>%
  addLegend(pal = pal,
            values = ~prix_moyen,
            opacity = 1.0,
            title = "Prix moyen nuit/personne")

tabsetPanel(type = "tabs",
                  tabPanel("Quartiers", m_bnb_prix_moyen_quartiers),
                  tabPanel("Arrondissements", m_bnb_prix_moyen_arrdt))
```
<div style="text-align: justify">Sans surprise, les offres de logement les plus chères se situent dans les ZTI (Zones Touristiques Internationales).  
On constate des écarts allant du double au triple selon l'arrondissement dans lesquel l'offre de logement se trouve. Au sein des quartiers d'un même arrondissement, l'écart est moins important mais reste tout de même conséquent (de l'ordre de 60% pour le 16ème arrondissement par exemple).


####Estimations des loueurs professionnels


It's also possible to embed an entire Shiny application within an R Markdown document using the `shinyAppDir` function. This example embeds a Shiny application located in another directory:

```{r tabsets, echo=FALSE}
shinyAppDir(
  system.file("examples/06_tabsets", package = "shiny"),
  options = list(
    width = "100%", height = 550
  )
)
```

Note the use of the `height` parameter to determine how much vertical space the embedded application should occupy.

You can also use the `shinyApp` function to define an application inline rather then in an external directory.

In all of R code chunks above the `echo = FALSE` attribute is used. This is to prevent the R code within the chunk from rendering in the document alongside the Shiny components.



